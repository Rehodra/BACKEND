<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Nimi Blog - Home</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
  <style>
    body { font-family: 'Inter', sans-serif; }
    .bg-gradient-dark { background: linear-gradient(135deg, #1f2937 0%, #111827 100%); }
    .card-dark { background-color: #1f2937; }
    .hero-title { animation: fadeInDown 1s ease-out; }
    @keyframes fadeInDown { from {opacity:0; transform:translateY(-20px);} to {opacity:1; transform:translateY(0);} }
    .post-card { background-color:#1f2937; border-left:4px solid transparent; transition: all 0.3s ease-in-out; cursor:pointer; }
    .post-card:hover { border-left-color:#0ea5e9; background-color:rgba(31,41,55,0.5); transform:translateY(-4px); box-shadow:0 10px 15px -3 rgba(0,0,0,0.2),0 4px 6px -2 rgba(0,0,0,0.05);}
    .carousel-item { display:none; animation:slideIn 0.5s ease-out; min-width:100%; }
    .carousel-item.active { display:block; }
    @keyframes slideIn { from {opacity:0; transform:translateX(20px);} to {opacity:1; transform:translateX(0);} }
  </style>
</head>

<body class="bg-gradient-dark min-h-screen antialiased p-4 sm:p-6 lg:p-12">

  <!-- Header -->
  <header class="mb-12 flex justify-between items-center max-w-7xl mx-auto relative">
    <h1 class="text-2xl sm:text-3xl font-extrabold text-sky-500 flex items-center">
      <i class="fas fa-feather-alt mr-3"></i> Nimi Blog
    </h1>

    <!-- Hamburger Button (mobile only) -->
    <button id="menu-btn" class="text-white text-2xl focus:outline-none lg:hidden">
      <i class="fas fa-bars"></i>
    </button>

    <!-- Navbar Links -->
    <nav id="menu" class="hidden lg:flex flex-col lg:flex-row lg:space-x-6 absolute lg:static top-full left-0 w-full lg:w-auto bg-gray-900 lg:bg-transparent rounded-lg lg:rounded-none mt-4 lg:mt-0 p-4 lg:p-0 space-y-4 lg:space-y-0 shadow-lg lg:shadow-none z-50">
      <a href="/" class="text-white font-medium transition duration-150 border-b-2 border-sky-500 pb-1 lg:pb-0"><i class="fas fa-home mr-1"></i> Home</a>
      <a href="/profile" class="text-gray-300 hover:text-sky-500 font-medium transition duration-150"><i class="fas fa-user mr-1"></i> Profile</a>
      <a href="/contact" class="text-gray-300 hover:text-sky-500 font-medium transition duration-150"><i class="fas fa-envelope mr-1"></i> Contact Us</a>
      <% if (!token) { %>
        <a href="/register" class="text-gray-300 hover:text-sky-500 font-medium transition duration-150"><i class="fas fa-sign-in-alt mr-1"></i> Sign Up</a>
      <% } else { %>
        <a href="/logout" class="text-gray-300 hover:text-red-500 font-medium transition duration-150"><i class="fas fa-sign-out-alt mr-1"></i> Log Out</a>
      <% } %>
    </nav>
  </header>

  <div class="max-w-7xl mx-auto">

    <!-- Hero Section -->
    <div class="text-center py-16 sm:py-20 mb-12 border-b border-gray-700 px-2">
      <h2 class="hero-title text-4xl sm:text-5xl lg:text-6xl font-extrabold text-white tracking-tight mb-4">
        Welcome to the <span class="text-sky-500">Nimi Blog</span>
      </h2>
      <p class="text-base sm:text-lg lg:text-xl text-gray-400 max-w-3xl mx-auto">
        Explore the latest insights, stories, and thoughts shared by our community. Discover new perspectives every day.
      </p>

      <form action="/search" method="GET" class="max-w-xl mx-auto mt-8 px-2">
        <div class="flex items-center bg-gray-700 rounded-full overflow-hidden shadow-2xl border-2 border-gray-600 focus-within:border-sky-500 transition duration-300">
          <input type="search" name="q" placeholder="Search for posts, topics, or authors..." 
                 class="w-full px-4 sm:px-6 py-3 text-base sm:text-lg text-white bg-gray-700 focus:outline-none placeholder-gray-400" aria-label="Search Blog Posts">
          <button type="submit" class="px-5 sm:px-6 py-3 bg-sky-600 text-white hover:bg-sky-700 transition duration-300">
            <i class="fas fa-search text-lg sm:text-xl"></i>
          </button>
        </div>
      </form>

      <a href="/write-post" class="mt-8 inline-flex items-center px-6 sm:px-8 py-3 bg-sky-600 text-white text-base sm:text-lg font-semibold rounded-full hover:bg-sky-700 transition duration-300 shadow-xl transform hover:-translate-y-1 hover:scale-105">
        <i class="fas fa-plus-circle mr-3"></i> Write Your Own Post
      </a>
    </div>

    <!-- Featured Posts Carousel Section -->
    <h3 class="text-2xl sm:text-3xl font-bold text-white mb-8 border-b-4 border-sky-500 inline-block pb-1">
      <i class="fas fa-rocket mr-2 text-sky-500"></i> Featured Posts from the Community
    </h3>

    <div id="featured-carousel" class="relative">
      <% if (posts.length > 0) { %>
        <div id="carousel-inner" class="relative overflow-hidden rounded-xl shadow-2xl">
          <% posts.forEach((post, index) => { %>
            <div class="carousel-item card-dark p-6 sm:p-8 rounded-xl <%= index===0?'active':''%>">
              <div class="post-card p-4 sm:p-6 shadow-xl border-sky-500 bg-gray-800/50">
                <h4 class="text-2xl sm:text-3xl font-extrabold text-sky-400 mb-3"><%= post.title %></h4>
                <div class="flex flex-wrap items-center text-gray-400 text-sm mb-4 space-x-2 sm:space-x-4">
                  <span class="font-medium"><i class="fas fa-user-edit mr-1 text-sky-500"></i>By: <%= post.author.userName %></span>
                  <span class="font-medium"><i class="fas fa-calendar-alt mr-1 text-sky-500"></i><%= post.createdAt.toDateString() %></span>
                  <span class="font-medium"><i class="fas fa-thumbs-up mr-1 text-sky-500"></i> <%= post.likes.length %> Likes</span>
                </div>
                <p class="text-base sm:text-lg text-gray-300 mb-6 line-clamp-4"><%= post.content.substring(0,250) %>...</p>
                <a href="/single-blog/<%= post._id %>" class="inline-flex items-center px-5 sm:px-6 py-2 bg-sky-600 text-white font-semibold rounded-full hover:bg-sky-700 transition duration-150">
                  Read Full Article <i class="fas fa-long-arrow-alt-right ml-2"></i>
                </a>
              </div>
            </div>
          <% }) %>
        </div>

        <!-- Carousel Buttons -->
        <button id="prevBtn" class="absolute top-1/2 left-2 sm:left-4 transform -translate-y-1/2 text-white bg-gray-900/50 p-2 sm:p-3 rounded-full hover:bg-gray-900/80 transition duration-200 focus:outline-none z-10 shadow-lg">
          <i class="fas fa-chevron-left"></i>
        </button>
        <button id="nextBtn" class="absolute top-1/2 right-2 sm:right-4 transform -translate-y-1/2 text-white bg-gray-900/50 p-2 sm:p-3 rounded-full hover:bg-gray-900/80 transition duration-200 focus:outline-none z-10 shadow-lg">
          <i class="fas fa-chevron-right"></i>
        </button>
      <% } else { %>
        <div class="text-center py-12 text-gray-500 card-dark rounded-xl">
          <i class="fas fa-folder-open text-5xl mb-3 text-gray-600"></i>
          <p class="text-lg sm:text-xl font-medium text-white mb-2">No featured posts available from the community right now.</p>
          <p>Be the first to share your insights, or wait for other members to post!</p>
        </div>
      <% } %>
    </div>

    <div class="text-center mt-12">
      <a href="#" class="text-lg text-sky-500 hover:text-sky-400 font-semibold transition duration-150">
        View All Posts <i class="fas fa-chevron-right ml-2 text-sm"></i>
      </a>
    </div>

  </div>

  <!-- JS for Carousel + Navbar -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // Carousel Logic
      const items = document.querySelectorAll('#carousel-inner .carousel-item');
      const prevBtn = document.getElementById('prevBtn');
      const nextBtn = document.getElementById('nextBtn');
      let currentIndex = 0;

      function showItem(index) {
        items.forEach(item => { item.classList.remove('active'); item.style.display='none'; });
        items[index].classList.add('active');
        items[index].style.display='block';
        currentIndex = index;
      }

      function nextItem() {
        let newIndex = currentIndex + 1;
        if (newIndex >= items.length) newIndex = 0;
        showItem(newIndex);
      }

      function prevItem() {
        let newIndex = currentIndex - 1;
        if (newIndex < 0) newIndex = items.length - 1;
        showItem(newIndex);
      }

      if(items.length > 1){
        showItem(currentIndex);
        nextBtn.addEventListener('click', nextItem);
        prevBtn.addEventListener('click', prevItem);
        setInterval(nextItem, 5000);
      } else {
        if(prevBtn) prevBtn.style.display = 'none';
        if(nextBtn) nextBtn.style.display = 'none';
      }

      // Hamburger Menu
      const menuBtn = document.getElementById('menu-btn');
      const menu = document.getElementById('menu');

      menuBtn.addEventListener('click', () => {
        menu.classList.toggle('hidden');
        menu.classList.toggle('flex');
      });
    });
  </script>
</body>
</html>
